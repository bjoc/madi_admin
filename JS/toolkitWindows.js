(function ($){ initWins = function (_cont) {	winArray = new Array;	windowUnderResize = 0;	winCont = _cont;	winHeaderHeight = 40;}})(jQuery);(function ($){ initWin = function (_title) {	// hívás: initWin(title);	// létrehozott win body-ja: $actWinBody;		var maxWinID = 0;	$(".winAbs").each(function(){		var $this = $(this);		$this.attr("active",0).css("z-index",0);		$this.find(".winRel").attr("active","0");		$this.find(".winHead").attr("active","0");		var actWinID = parseInt($this.attr("winID"));		if (actWinID > maxWinID) maxWinID = actWinID;	});	if (maxWinID == 0) maxWinID = 10; // z-index minimuma is	var nexWinID = maxWinID + 1;	actWinID = nexWinID;	var $cont = $("#"+winCont);	contWidth = $cont.width();	contHeight = $cont.height();	var def = "<div class='winAbs shadowed' winID='" + actWinID + "' id='win" + actWinID + "' style='opacity:0' maximized='0'>";	def    += "<div class='winRel'><div class='winHead'></div>";	def    += "<div class='winBody'></div>";	def    += "<div class='winClose'><img src='images/ico_close.png'></div>";	def    += "<div class='winMaxim'><img src='images/ico_maximize.png'></div></div>";	def    += "<div class='winRRes'></div><div class='winBRes'></div>";	def    += "<div class='winLRes'></div><div class='winTRes'></div>";	def    += "<div class='winRBRes'></div><div class='winLBRes'></div>";	def    += "<div class='winRTRes'></div><div class='winLTRes'></div>";	def    += "</div>";		$cont.append(def);	var $thisWin = $("#win"+actWinID);	$actWinBody = $thisWin.find(".winBody");	$thisWin.find(".winHead").html(_title);	makeActive($thisWin);		$thisWin.on("mousedown", function(){		makeActive($(this));	});		winArray[actWinID] = new Array;		var winShift = (actWinID - 11) * 30;		winArray[actWinID][0] = 15 + winShift; // left	winArray[actWinID][1] = 15 + winShift; // top	winArray[actWinID][2] = contWidth - 30 - winShift; // width	winArray[actWinID][3] = contHeight - 30- winShift; // height	winArray[actWinID][4] = 0; // resize direction: 1 top, 2: righttop, 3: right, 4:rightbottom, 5: bottom, 6: leftbottom, 7:left, 8:lefttop		var bodyHeight = winHeaderHeight + 5;		$thisWin.css("left",winArray[actWinID][0]+"px");	$thisWin.css("top",winArray[actWinID][1]+"px");	$thisWin.css("width",winArray[actWinID][2]+"px");	$thisWin.css("height",winArray[actWinID][3]+"px");	$actWinBody.css("width",winArray[actWinID][2]-5+"px");	$actWinBody.css("height",winArray[actWinID][3]-bodyHeight+"px");	//	TweenMax.to($thisWin, 0.5, {opacity:1, ease:Linear.easeNone});	$thisWin.css("opacity", 1);	$thisWin.find(".winRRes").on("mousedown", function(e) {		if (e.which === 1) {			e.preventDefault();			var actID = $(this).parent().attr("winID");	    	winArray[actID][4] = 3;	    	winArray[actID][5] = e.pageX;	    	winArray[actID][6] = 0; // no vertical resize	    	windowUnderResize = actID;	    	iniNews(actID);			contWidth = $cont.width();			contHeight = $cont.height();		}    });    	$thisWin.find(".winLRes").on("mousedown", function(e) {		if (e.which === 1) {			e.preventDefault();			var actID = $(this).parent().attr("winID");	    	winArray[actID][4] = 7;	    	winArray[actID][5] = e.pageX;	    	winArray[actID][6] = 0; // no vertical resize	    	windowUnderResize = actID;	    	iniNews(actID);			contWidth = $cont.width();			contHeight = $cont.height();	    }    });	$thisWin.find(".winTRes").on("mousedown", function(e) {		if (e.which === 1) {			e.preventDefault();			var actID = $(this).parent().attr("winID");	    	winArray[actID][4] = 1;	    	winArray[actID][5] = 0; // no horizontal resize	    	winArray[actID][6] = e.pageY; 	    	windowUnderResize = actID;	    	iniNews(actID);			contWidth = $cont.width();			contHeight = $cont.height();    	}    });	$thisWin.find(".winBRes").on("mousedown", function(e) {		if (e.which === 1) {			e.preventDefault();			var actID = $(this).parent().attr("winID");	    	winArray[actID][4] = 5;	    	winArray[actID][5] = 0; // no horizontal resize	    	winArray[actID][6] = e.pageY; 	    	windowUnderResize = actID;	    	iniNews(actID);			contWidth = $cont.width();			contHeight = $cont.height();    	}    });	$thisWin.find(".winRTRes").on("mousedown", function(e) {		if (e.which === 1) {			e.preventDefault();			var actID = $(this).parent().attr("winID");	    	winArray[actID][4] = 2;	    	winArray[actID][5] = e.pageX;	    	winArray[actID][6] = e.pageY; 	    	windowUnderResize = actID;	     	iniNews(actID);			contWidth = $cont.width();			contHeight = $cont.height();     	}   });	$thisWin.find(".winRBRes").on("mousedown", function(e) {		if (e.which === 1) {			e.preventDefault();			var actID = $(this).parent().attr("winID");	    	winArray[actID][4] = 4;	    	winArray[actID][5] = e.pageX;	    	winArray[actID][6] = e.pageY; 	    	windowUnderResize = actID;	    	iniNews(actID);			contWidth = $cont.width();			contHeight = $cont.height();		}    });	$thisWin.find(".winLBRes").on("mousedown", function(e) {		if (e.which === 1) {			e.preventDefault();			var actID = $(this).parent().attr("winID");	    	winArray[actID][4] = 6;	    	winArray[actID][5] = e.pageX;	    	winArray[actID][6] = e.pageY; 	    	windowUnderResize = actID;	    	iniNews(actID);			contWidth = $cont.width();			contHeight = $cont.height();		}    });	$thisWin.find(".winLTRes").on("mousedown", function(e) {		if (e.which === 1) {			e.preventDefault();			var actID = $(this).parent().attr("winID");	    	winArray[actID][4] = 8;	    	winArray[actID][5] = e.pageX;	    	winArray[actID][6] = e.pageY; 	    	windowUnderResize = actID;	    	iniNews(actID);			contWidth = $cont.width();			contHeight = $cont.height();	    }    });    	$thisWin.find(".winHead").on("mousedown", function(e) {		if (e.which === 1) {			e.preventDefault();			var actID = $(this).parent().parent().attr("winID");	    	winArray[actID][4] = 0;	    	winArray[actID][5] = e.pageX;	    	winArray[actID][6] = e.pageY; 	    	windowUnderResize = actID;	    	iniNews(actID);			contWidth = $cont.width();			contHeight = $cont.height();		}    }).on("dblclick", function(e){		if (e.which === 1) {			e.preventDefault();			var actID = $(this).parent().parent().attr("winID");			winMaximize(actID);		}    });        $thisWin.find(".winClose").on("click", function(e) {		if (e.which === 1) {			e.preventDefault();			$(this).parent().parent().remove();			var $lastWin = $(".winAbs:last");			makeActive($lastWin);		}	});		    $thisWin.find(".winMaxim").on("click", function(e) {		if (e.which === 1) {			e.preventDefault();			var actID = $(this).parent().parent().attr("winID");			winMaximize(actID);		}	});	function winMaximize(actID){			var $win = $("#win"+actID);			var $body = $win.find(".winBody");			if ($win.attr("Maximized") == 0) {				var cont_wi = $cont.width();				var cont_he = $cont.height();				winArray[actID][10] = winArray[actID][0]; // left				winArray[actID][11] = winArray[actID][1]; // top				winArray[actID][12] = winArray[actID][2]; // width				winArray[actID][13] = winArray[actID][3]; // height				TweenMax.to($win, 0.2, {left:0, top:0, width:cont_wi+"px", height:cont_he+"px", ease:Linear.easeNone});				TweenMax.to($body, 0.2, {width:cont_wi - 5 +"px", height:cont_he - bodyHeight +"px", ease:Linear.easeNone, onComplete:function(){					customUserFunction("#win"+actID);					$win.attr("maximized",1);				}});			} else {				winArray[actID][0] = winArray[actID][10]; // left				winArray[actID][1] = winArray[actID][11]; // top				winArray[actID][2] = winArray[actID][12]; // width				winArray[actID][3] = winArray[actID][13]; // height				TweenMax.to($win, 0.2, {left:winArray[actID][10]+"px", top:winArray[actID][11]+"px", width:winArray[actID][12]+"px", height:winArray[actID][13]+"px", ease:Linear.easeNone});				TweenMax.to($body, 0.2, {width:winArray[actID][12] - 5 + "px", height:winArray[actID][13] - bodyHeight + "px", ease:Linear.easeNone, onComplete:function(){					customUserFunction("#win"+actID);					$win.attr("maximized",0);								}});			}	}	    function iniNews(actID){	    newL = winArray[actID][0];	    newT = winArray[actID][1];	    newW = winArray[actID][2];	    newH = winArray[actID][3];    }	$(document).off("mousemove").on("mousemove",function(e) {		if (windowUnderResize > 0) {					winLeft = winArray[windowUnderResize][0];			winTop = winArray[windowUnderResize][1];			winWidth = winArray[windowUnderResize][2];			winHeight = winArray[windowUnderResize][3];			winDir = winArray[windowUnderResize][4]						// resize direction: 1 top, 2: righttop, 3: right, 4:rightbottom, 5: bottom, 6: leftbottom, 7:left, 8:lefttop; 0:move			winStartX = winArray[windowUnderResize][5];			winStartY = winArray[windowUnderResize][6];			var el = document.getElementById("win"+windowUnderResize);			if (winDir == 0) { // move			 		var diffX = e.pageX - winStartX;			 		var diffY = e.pageY - winStartY;				    	newL = winLeft + diffX;				    	newT = winTop + diffY;					if (newL < - 150) {						newL = 0;						newT = 0;						newW = contWidth / 2;						newH = contHeight;				    	el.style.width = newW + "px";				    	el.style.height = newH + "px";						winArray[windowUnderResize][0] = newL;						winArray[windowUnderResize][1] = newT;						winArray[windowUnderResize][2] = newW;						winArray[windowUnderResize][3] = newH;				    	windowUnderResize = 0;					}					if (newL > contWidth - newW + 150) {						newL = contWidth / 2 ;						newT = 0;						newW = contWidth / 2;						newH = contHeight;				    	el.style.width = newW + "px";				    	el.style.height = newH + "px";						winArray[windowUnderResize][0] = newL;						winArray[windowUnderResize][1] = newT;						winArray[windowUnderResize][2] = newW;						winArray[windowUnderResize][3] = newH;				    	windowUnderResize = 0;					}					if (newT < -50) {						newL = 0;						newT = 0;						newW = contWidth;						newH = contHeight / 2;				    	el.style.width = newW + "px";				    	el.style.height = newH + "px";						winArray[windowUnderResize][0] = newL;						winArray[windowUnderResize][1] = newT;						winArray[windowUnderResize][2] = newW;						winArray[windowUnderResize][3] = newH;				    	windowUnderResize = 0;					}					if (newT > contHeight - newH + 50) {						newL = 0;						newT = contHeight / 2;						newH = contHeight / 2;						newW = contWidth;				    	el.style.width = newW + "px";				    	el.style.height = newH + "px";						winArray[windowUnderResize][0] = newL;						winArray[windowUnderResize][1] = newT;						winArray[windowUnderResize][2] = newW;						winArray[windowUnderResize][3] = newH;				    	windowUnderResize = 0;					}			    	el.style.left = newL + "px";			    	el.style.top = newT + "px";			    	el.setAttribute("maximized", 0);			    				} else { // resize				if (winStartX > 0) { // width changes 			 		var diffX = e.pageX - winStartX;			    	if (winDir >= 6) { // left changes				    	newL = winLeft + diffX;				    	newW = winWidth - diffX;			    	} else {				    	newW = winWidth + diffX;			    	}			    	if (newW <= 200) newW = 200;			    	el.style.left = newL + "px";			    	el.style.width = newW + "px";			    	el.setAttribute("maximized", 0);				}					if (winStartY > 0) { // height changes			 		var diffY = e.pageY - winStartY;			    	if (winDir <= 2 || winDir == 8) { // top changes				    	newT = winTop + diffY;				    	newH = winHeight - diffY;			    	} else {				    	newH = winHeight + diffY;			    	}			    	if (newH <= 50) newH = 50;			    	el.style.top = newT + "px";			    	el.style.height = newH + "px";			    	el.setAttribute("maximized", 0);					}			}						var el2 = el.querySelector(".winBody");		   	el2.style.width = newW - 5 + "px";		    el2.style.height = newH - bodyHeight + "px";		    		    customUserFunction("#win"+windowUnderResize);		}    }).on("mouseup", function() {		if (windowUnderResize > 0) {			// resize direction: 1 top, 2: righttop, 3: right, 4:rightbottom, 5: bottom, 6: leftbottom, 7:left, 8:lefttop				winArray[windowUnderResize][0] = newL;				winArray[windowUnderResize][1] = newT;				winArray[windowUnderResize][2] = newW;				winArray[windowUnderResize][3] = newH;						}		windowUnderResize = 0;	});	}})(jQuery);(function ($){ makeActive = function (el) {		$(".winAbs").not(el).each(function(){			var $this = $(this);			$this.attr("active",0).css("z-index",0);			$this.find(".winRel").attr("active","0");			$this.find(".winHead").attr("active","0");		});		el.attr("active","1").css("z-index",1);		el.find(".winRel").attr("active","1");		el.find(".winHead").attr("active","1");	}})(jQuery);(function ($){ customUserFunction = function (el) {			var $bod = $(el).find(".winBody");			$bod.find(".formPageCont").height($bod.height() - 65 + "px");}})(jQuery);