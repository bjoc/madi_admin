<?php 	ini_set("allow_url_fopen", true);	require("smart_resize_image.function.php");	set_time_limit(0);		$max_width = $_GET['max_width'];	$max_quality = $_GET['max_quality'];	$uploaddir = $_GET['site_img'];	        $message = 'Error uploading file';        switch( $_FILES['afile']['error'] ) {            case UPLOAD_ERR_OK:                $message = false;;                break;            case UPLOAD_ERR_INI_SIZE:            case UPLOAD_ERR_FORM_SIZE:                $message .= ' - file too large (limit of ... bytes).';                break;            case UPLOAD_ERR_PARTIAL:                $message .= ' - file upload was not completed.';                break;            case UPLOAD_ERR_NO_FILE:                $message .= ' - zero-length file uploaded.';                break;            default:                $message .= ' - internal error #'.$_FILES['afile']['error'];                break;        }                      if( !$message ) {            if( !is_uploaded_file($_FILES['afile']['tmp_name']) ) {                $message = 'Error uploading file - unknown error.';            } else {                $dest = $uploaddir . "_tmp_" . $_FILES['afile']['name'];//                $destsmall  = $uploaddir . "_tmp_sm_" . $_FILES['afile']['name'];                                 // mivel feltételezi, hogy az /admin/ egy szinten van a /website/ -tal,                 // és ez a php az /admin/inklud/ almappában van, ezért az $uploaddit elé kell egy "../"                if (!is_uploaded_file($_FILES["afile"]["tmp_name"])) {                	$message = 'Error uploading file - cannot create temp file';                } else                 if( !move_uploaded_file( $_FILES['afile']['tmp_name'],  '../' . $dest) ) {                	$message = 'Error uploading file - could not save upload (this will probably be a permissions problem in '.$dest.')';				} else {					smart_resize_image('../' .$dest , null, intval($max_width), 0 , true , '../' .$dest , false , false , intval($max_quality) );                     $message = 'OK';                }            }        }$json = json_encode(array(  'name' => $_FILES['afile']['name'],  'type' => $_FILES['afile']['type'],  'url' => $dest,  'error' => $message));echo $json;?>